# Простая система управления HR

Простая система управления `HR`, построенная на `Flask` для управления сотрудниками, отделами, должностями, приказами и отпусками.

## Возможности

- Аутентификация пользователей (**роли admin/hr**)
- Управление сотрудниками (**операции CRUD**)
- Управление отделами и должностями
- Управление приказами (**прием, переводы, увольнения**)
- Отслеживание отпусков с календарем
- Расширенные возможности отчетности
- Функциональность импорта/экспорта `CSV`
- Адаптивный веб-интерфейс

## Используемые технологии

- **Бэкенд**: Flask (Python)
- **База данных**: MySQL с ORM SQLAlchemy (поддержка SQLite для тестирования)
- **Фронтенд**: Bootstrap 5, HTML, CSS
- **Аутентификация**: Flask-Login
- **Обработка данных**: pandas, chardet
- **Визуализация данных**: matplotlib, seaborn, plotly
- **Формы**: Flask-WTF, WTForms

## Предварительные требования

*   **Python 3.10:**  Для запуска этого приложения необходима версия Python 3.10.

## Установка

1.  **Убедитесь, что у вас установлена Python 3.10:**

    Откройте терминал и выполните:

    ```bash
    python3 --version
    ```

    или

     ```bash
     python --version
     ```

    Убедитесь, что вывод показывает `Python 3.10.x` (где x - номер патча). Если нет, вам нужно установить Python 3.10. Инструкции по установке можно найти на официальном сайте Python: [https://www.python.org/downloads/release/python-3100/](https://www.python.org/downloads/release/python-3100/)


2. Клонируйте репозиторий:

   ```bash
   git clone <repository-url>
   cd simple_hr
   ```

3. Создайте виртуальное окружение:

   ```bash
   python -m venv venv
   ```
   ```bash
   source venv/bin/activate  # В Windows: venv\Scripts\activate
   ```

4.  **(При необходимости) Обновите pip и virtualenv:**

     Это *обычно* не требуется, но иногда устраняет проблемы с установкой. Если при установке зависимостей возникают проблемы, попробуйте это.

    ```bash
    python -m pip install --upgrade pip
    ```
    ```bash
    pip install --upgrade virtualenv
    ```
    **Важно:** На системах Windows, где команды `python` и `pip` могут быть связаны с Python 2.x, вместо этого может потребоваться использовать команду `python3` для обновления `pip`:

    ```bash
    python3 -m pip install --upgrade pip
    ```
    
5. **Установите зависимости:**

   ```bash
   pip install -r requirements.txt
   ```

6. **База данных:**

    По умолчанию приложение использует базу данных SQLite, файл которой хранится локально (например, `instance/simple_hr_test.db`).
    
    #### Настройка MySQL (Production)
   - Создайте базу данных `MySQL` 
   - Обновите файл `.env` своими учетными данными базы данных
   - **Запустите SQL-скрипт для создания таблиц:**

     ```bash
     mysql -u username -p database_name < create_simple_hr_db.sql
     ```

7. **Настройте переменные окружения в `.env`:**

   ```bash
   SECRET_KEY=your_secret_key_here
   MYSQL_USER=your_mysql_username
   MYSQL_PASSWORD=your_mysql_password
   MYSQL_HOST=localhost
   MYSQL_DB=simple_hr_db
   ```

8. **Заполните начальные данные:**

   ```bash
   python seed_data.py
   ```

## Запуск приложения

```bash
python run.py
```

Приложение будет доступно по адресу `http://localhost:5000`

```bash
python run.py mode --dev
```

## Решение проблем

### Ошибка "error registering blueprints: numpy.dtype size changed"

Иногда при запуске приложения вы можете столкнуться с ошибкой, связанной с `numpy`:

error registering blueprints: numpy.dtype size changed


Это часто связано с конфликтом версий `numpy` или несовместимостью с другими библиотеками. Чтобы исправить это, выполните следующие действия *находясь в активированном виртуальном окружении*:

1.  **Удалите `numpy`:**

    ```bash
    pip uninstall numpy
    ```

    В большинстве случаев это решает проблему. Если ошибка сохраняется, попробуйте обновить другие основные библиотеки, такие как `scipy` и `pandas`. Также, если в вашем `requirements.txt` указана конкретная версия `numpy`, попробуйте её удалить и установить последнюю доступную версию.


## Пользователи по умолчанию

- Администратор: имя пользователя `admin`, пароль `admin`
- HR: имя пользователя `hr`, пароль `hr`

## Структура проекта

```bash
simple_hr/
├── app/
│   ├── routes/          # Обработчики маршрутов
│   ├── templates/       # HTML шаблоны
│   ├── utils/           # Вспомогательные функции
│   ├── __init__.py      # Фабрика приложения
│   └── models.py        # Модели базы данных
├── instance/
│   └── config.py        # Конфигурация
├── .env                 # Переменные окружения
├── create_simple_hr_db.sql  # Схема базы данных
├── requirements.txt     # Зависимости
├── run.py              # Точка входа в приложение
└── seed_data.py        # Начальное заполнение данных
```

## Функциональность

### Управление сотрудниками

- Добавление, редактирование, удаление сотрудников
- Просмотр деталей сотрудника
- Фильтрация сотрудников по отделам

### Управление отделами и должностями

- Управление отделами и должностями
- Предотвращение удаления при использовании

### Приказы

- Создание приказов о приеме, переводах и увольнениях
- Отслеживание перемещений сотрудников

### Отпуска

- Запись отпусков сотрудников
- Отслеживание типов отпусков (оплачиваемый, неоплачиваемый, больничный)
- Календарный вид отпусков
- Проверка на пересечение отпусков

### Отчеты

- Генерация отчетов по сотрудникам
- Экспорт данных в CSV
- Просмотр статистики по отделам
- Отчет по производительности
- Зарплатный отчет
- Аналитика текучести кадров

### Импорт/Экспорт CSV

- Импорт данных сотрудников из CSV файлов
- Экспорт отчетов в формат CSV
- Автоматическое определение кодировки

## Лицензия

Этот проект предназначен для образовательных целей.